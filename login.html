<!DOCTYPE html>
<html lang="ru">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É - –≠—Ç–∞–∂–∏‚ÇΩlay</title>
	<style>
		:root {
			--main-bg: #f7faff;
			--main-text: #1e293b;
			--main-subtext: #64748b;
			--main-accent: #007aff;
			--main-accent-dark: #0051d2;
			--main-card: #ffffff;
			--apple-gray-50: #f9fafb;
			--apple-gray-100: #f3f4f6;
			--apple-gray-200: #e5e7eb;
			--apple-gray-300: #d1d5db;
			--apple-gray-400: #9ca3af;
			--apple-gray-500: #6b7280;
			--main-success: #10b981;
			--main-error: #ef4444;
		}

		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', system-ui, sans-serif;
			background: linear-gradient(135deg, var(--main-bg) 0%, #ffffff 100%);
			min-height: 100vh;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 20px;
		}

		.login-container {
			background: var(--main-card);
			border-radius: 30px;
			padding: 40px;
			width: 100%;
			max-width: 480px;
			box-shadow: 0 25px 80px rgba(0, 0, 0, 0.08);
			border: 2px solid var(--apple-gray-100);
		}

		.logo {
			text-align: center;
			margin-bottom: 32px;
		}

		.logo img {
			height: 80px;
			transition: transform 0.3s ease;
		}

		.logo img:hover {
			transform: scale(1.05);
		}

		.login-header {
			text-align: center;
			margin-bottom: 32px;
		}

		.login-title {
			color: var(--main-text);
			font-size: 28px;
			font-weight: 700;
			margin-bottom: 8px;
		}

		.login-subtitle {
			color: var(--main-subtext);
			font-size: 16px;
			line-height: 1.5;
		}

		.form-group {
			margin-bottom: 24px;
		}

		.form-label {
			display: block;
			color: var(--main-text);
			font-size: 14px;
			font-weight: 600;
			margin-bottom: 8px;
		}

		.form-input {
			width: 100%;
			padding: 16px 20px;
			border: 2px solid var(--apple-gray-200);
			border-radius: 20px;
			font-size: 16px;
			color: var(--main-text);
			background: var(--apple-gray-50);
			transition: all 0.3s ease;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
		}

		.form-input:focus {
			outline: none;
			border-color: var(--main-accent);
			background: white;
			box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
		}

		.form-input::placeholder {
			color: rgba(100, 116, 139, 0.3);
			opacity: 1;
		}

		.form-input::-webkit-input-placeholder {
			color: rgba(100, 116, 139, 0.3);
		}

		.form-input::-moz-placeholder {
			color: rgba(100, 116, 139, 0.3);
			opacity: 1;
		}

		.form-input:-ms-input-placeholder {
			color: rgba(100, 116, 139, 0.3);
		}

		.form-input.error {
			border-color: var(--main-error);
			background: #fef2f2;
		}

		.form-input.success {
			border-color: var(--main-success);
			background: #f0fdf4;
		}

		.error-message {
			color: var(--main-error);
			font-size: 14px;
			margin-top: 8px;
			display: none;
		}

		.success-message {
			color: var(--main-success);
			font-size: 14px;
			margin-top: 8px;
			display: none;
		}

		.login-button {
			width: 100%;
			background: var(--main-accent);
			color: white;
			border: none;
			border-radius: 25px;
			padding: 16px 24px;
			font-size: 16px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.3s ease;
			margin-bottom: 20px;
			box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
		}

		.login-button:hover {
			background: var(--main-accent-dark);
			transform: translateY(-2px);
			box-shadow: 0 8px 20px rgba(0, 122, 255, 0.4);
		}

		.login-button:disabled {
			background: var(--apple-gray-300);
			cursor: not-allowed;
			transform: none;
			box-shadow: none;
		}

		.info-box {
			background: var(--apple-gray-50);
			border: 1px solid var(--apple-gray-200);
			border-radius: 20px;
			padding: 16px;
			margin-bottom: 24px;
		}

		.info-title {
			color: var(--main-text);
			font-size: 14px;
			font-weight: 600;
			margin-bottom: 8px;
		}

		.info-text {
			color: var(--main-subtext);
			font-size: 13px;
			line-height: 1.5;
		}

		.loading {
			display: none;
			text-align: center;
			padding: 20px;
		}

		.spinner {
			border: 3px solid var(--apple-gray-200);
			border-top: 3px solid var(--main-accent);
			border-radius: 50%;
			width: 30px;
			height: 30px;
			animation: spin 1s linear infinite;
			margin: 0 auto 16px;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		.back-link {
			text-align: center;
			margin-top: 24px;
		}

		.back-link a {
			color: var(--main-accent);
			text-decoration: none;
			font-size: 14px;
			font-weight: 500;
		}

		.back-link a:hover {
			text-decoration: underline;
		}

		.alternative-section {
			text-align: center;
			margin: 24px 0;
			color: var(--main-subtext);
			font-size: 14px;
		}

		.alternative-button {
			width: 100%;
			background: var(--apple-gray-100);
			color: var(--main-text);
			border: 2px solid var(--apple-gray-200);
			border-radius: 25px;
			padding: 14px 24px;
			font-size: 14px;
			font-weight: 500;
			cursor: pointer;
			transition: all 0.3s ease;
			text-decoration: none;
			display: inline-block;
			text-align: center;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
		}

		.alternative-button:hover {
			background: var(--apple-gray-200);
			border-color: var(--apple-gray-300);
			transform: translateY(-2px);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		}

		.buttons-row {
			display: flex;
			gap: 12px;
			margin-top: 16px;
		}

		.half-button {
			flex: 1;
			background: var(--apple-gray-100);
			color: var(--main-text);
			border: 2px solid var(--apple-gray-200);
			border-radius: 25px;
			padding: 14px 16px;
			font-size: 14px;
			font-weight: 500;
			cursor: pointer;
			transition: all 0.3s ease;
			text-decoration: none;
			display: inline-block;
			text-align: center;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
		}

		.half-button:hover {
			background: var(--apple-gray-200);
			border-color: var(--apple-gray-300);
			transform: translateY(-2px);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		}

		@media (max-width: 768px) {
			.login-container {
				padding: 24px;
				margin: 16px;
			}

			.login-title {
				font-size: 24px;
			}
		}

		/* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–∞—Ä–æ–ª—è */
		.modal {
			display: none;
			position: fixed;
			z-index: 1000;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.6);
			backdrop-filter: blur(8px);
		}

		.modal-content {
			background-color: var(--main-card);
			margin: 10% auto;
			padding: 0;
			border-radius: 25px;
			width: 90%;
			max-width: 500px;
			box-shadow: 0 25px 80px rgba(0, 0, 0, 0.25);
			animation: modalSlideIn 0.4s ease;
			border: 2px solid var(--main-accent);
		}

		.modal-header {
			padding: 25px;
			border-bottom: 1px solid var(--apple-gray-200);
		}

		.modal-body {
			padding: 25px;
		}

		@keyframes modalSlideIn {
			from {
				opacity: 0;
				transform: translateY(-50px) scale(0.9);
			}

			to {
				opacity: 1;
				transform: translateY(0) scale(1);
			}
		}
	</style>
</head>

<body>
	<div class="login-container">
		<div class="logo">
			<img src="https://i.postimg.cc/zGjfVHdx/image.png" alt="–≠—Ç–∞–∂–∏‚ÇΩlay">
		</div>

		<div class="login-header">
			<h1 class="login-title">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h1>
			<p class="login-subtitle">
				–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–æ—á—Ç—É –¥–ª—è –≤—Ö–æ–¥–∞ –∏ –ø–æ–ª—É—á–∏—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–æ–ª—å —Å –ø–æ–º–æ—â—å—é –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π –Ω–∏–∂–µ.
			</p>
		</div>

		<div class="info-box">
			<div class="info-title">–ö–∞–∫ –≤–æ–π—Ç–∏:</div>
			<div class="info-text">
				1. –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–æ—á—Ç—É @rostov.etagi.com<br>
				2. –ü–æ–ª—É—á–∏—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∏–∂–µ<br>
				3. –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ.
			</div>
		</div>

		<form id="loginForm">
			<div class="form-group">
				<label for="email" class="form-label">üìß –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞</label>
				<input type="email" id="email" name="email" class="form-input" placeholder="i.p.@rostov.etagi.com" required
					style="color: var(--main-text);">
				<div id="emailError" class="error-message"></div>
				<div id="emailSuccess" class="success-message"></div>
			</div>

			<div class="form-group">
				<label for="password" class="form-label">üîê –ü–∞—Ä–æ–ª—å</label>
				<input type="password" id="password" name="password" class="form-input"
					placeholder="–ü–∞—Ä–æ–ª—å –∏–∑ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π –Ω–∏–∂–µ" required>
				<div id="passwordError" class="error-message"></div>
				<div id="passwordSuccess" class="success-message"></div>
			</div>

			<button type="submit" id="loginButton" class="login-button">
				üöÄ –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
			</button>
		</form>
		<div class="buttons-row">
			<button id="generatePasswordButton" class="half-button">
				üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å
			</button>
			<a href="registration.html" class="half-button">
				üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
			</a>
		</div>
	</div>

	<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø–∞—Ä–æ–ª—è -->
	<div id="passwordModal" class="modal" style="display: none;">
		<div class="modal-content">
			<div class="modal-header">
				<h2 style="color: var(--main-accent); margin: 0; font-size: 24px; font-weight: 600; text-align: center;">
					üîë –í–∞—à –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –≥–æ—Ç–æ–≤!
				</h2>
			</div>
			<div class="modal-body">
				<div
					style="background: var(--apple-gray-50); border: 2px solid var(--main-accent); border-radius: 15px; padding: 20px; margin: 20px 0; text-align: center;">
					<p style="color: var(--main-text); font-size: 16px; margin-bottom: 15px; font-weight: 600;">
						üëá –°–ö–û–ü–ò–†–£–ô–¢–ï —ç—Ç–æ—Ç –ø–∞—Ä–æ–ª—å üëá
					</p>
					<div id="generatedPassword"
						style="background: white; border: 2px dashed var(--main-accent); border-radius: 10px; padding: 15px; font-family: monospace; font-size: 18px; font-weight: bold; color: var(--main-accent); letter-spacing: 2px; user-select: all; cursor: pointer;">
						<!-- –ü–∞—Ä–æ–ª—å –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω —Å—é–¥–∞ -->
					</div>
					<p style="color: var(--main-subtext); font-size: 12px; margin-top: 10px;">
						üí° –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø–∞—Ä–æ–ª—å —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
					</p>
				</div>

				<div
					style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 10px; padding: 15px; margin: 15px 0;">
					<p style="color: #856404; font-size: 14px; margin: 0; text-align: center;">
						<strong>üìù –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï:</strong><br>
						1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞—Ä–æ–ª—å (–∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ)<br>
						2. –í—Å—Ç–∞–≤—å—Ç–µ –≤ –ø–æ–ª–µ "–ü–∞—Ä–æ–ª—å" –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ<br>
						3. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É"
					</p>
				</div>

				<button id="closePasswordModalBtn"
					style="width: 100%; background: var(--main-accent); color: white; border: none; border-radius: 25px; padding: 16px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 10px;">
					‚úÖ –ü–æ–Ω—è—Ç–Ω–æ, –∑–∞–∫—Ä—ã—Ç—å
				</button>
			</div>
		</div>
	</div>

	<script>
		// Google Sheets API –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
		const SPREADSHEET_ID = '1I59nc5HqphN0IJVoMCEAER29JQiphyDkvzXTRIfFi3s';
		const API_KEY = 'AIzaSyDlejl66tn6Ik2NPLcV3fyoarRbdOliaww';
		const SHEET_NAME = '—É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏';

		// –ü—Ä–æ–≤–µ—Ä–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
		async function testConnection() {
			try {
				const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;

				const response = await fetch(url);

				if (response.ok) {
					const data = await response.json();
					return true;
				} else {
					const errorText = await response.text();
					return false;
				}
			} catch (error) {
				return false;
			}
		}

		document.addEventListener('DOMContentLoaded', function () {
			// –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
			testConnection();

			// –≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã
			const loginForm = document.getElementById('loginForm');
			const emailInput = document.getElementById('email');
			const passwordInput = document.getElementById('password');
			const emailError = document.getElementById('emailError');
			const emailSuccess = document.getElementById('emailSuccess');
			const passwordError = document.getElementById('passwordError');
			const passwordSuccess = document.getElementById('passwordSuccess');
			const loginButton = document.getElementById('loginButton');

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ email –¥–æ–º–µ–Ω–∞
			function validateEmail(email) {
				const emailLower = email.toLowerCase().trim();

				if (!emailLower) {
					return { valid: false, message: '–í–≤–µ–¥–∏—Ç–µ email –∞–¥—Ä–µ—Å' };
				}

				if (!emailLower.includes('@')) {
					return { valid: false, message: '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email' };
				}

				if (!emailLower.endsWith('@rostov.etagi.com')) {
					return { valid: false, message: '–†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å–∞ @rostov.etagi.com' };
				}

				const username = emailLower.split('@')[0];
				if (username.length < 2) {
					return { valid: false, message: '–°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è' };
				}

				return { valid: true, message: '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω' };
			}

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
			function validatePassword(password) {
				if (!password) {
					return { valid: false, message: '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å' };
				}

				if (password.length < 4) {
					return { valid: false, message: '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π' };
				}

				return { valid: true, message: '–ü–∞—Ä–æ–ª—å –ø—Ä–∏–Ω—è—Ç' };
			}

			// –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Google Sheets
			async function findUserInGoogleSheets(email, password) {
				try {
					const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;

					const response = await fetch(url);

					if (!response.ok) {
						const errorText = await response.text();
						throw new Error(`–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Google Sheets: ${response.status} ${response.statusText}`);
					}

					const data = await response.json();

					const rows = data.values || [];

					// –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞)
					for (let i = 1; i < rows.length; i++) {
						const row = rows[i];
						const employeeId = row[0] ? row[0].toString().trim() : '';
						const rowEmail = row[1] ? row[1].toString().toLowerCase().trim() : '';
						const rowPassword = row[2] ? row[2].toString() : '';

						if (rowEmail === email.toLowerCase() && rowPassword === password) {
							return {
								email: rowEmail,
								password: rowPassword,
								employeeId: employeeId,
								id: employeeId
							};
						}
					}

					return null;
				} catch (error) {
					throw error;
				}
			}			// –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–Ω–∞—á–∞–ª–∞ –≤ localStorage, –ø–æ—Ç–æ–º –≤ Google Sheets)
			async function findUser(email, password) {
				try {
					// –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –≤ localStorage (–≥–¥–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
					const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');

					const localUser = registeredUsers.find(user => {
						const emailMatch = user.email === email.toLowerCase();
						const passwordMatch = user.password === password;
						return emailMatch && passwordMatch;
					});

					if (localUser) {
						return localUser;
					}

					// –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage, –ø—Ä–æ–≤–µ—Ä—è–µ–º Google Sheets
					const user = await findUserInGoogleSheets(email, password);
					if (user) {
						return user;
					}

					return null;
				} catch (error) {
					// –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ API, –ø—Ä–æ–≤–µ—Ä—è–µ–º localStorage –∫–∞–∫ fallback
					try {
						const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
						return registeredUsers.find(user =>
							user.email === email.toLowerCase() && user.password === password
						);
					} catch (localError) {
						return null;
					}
				}
			}

			// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ email
			emailInput.addEventListener('input', function () {
				const validation = validateEmail(this.value);

				emailError.style.display = 'none';
				emailSuccess.style.display = 'none';
				this.classList.remove('error', 'success');

				if (this.value.trim()) {
					if (validation.valid) {
						this.classList.add('success');
						emailSuccess.textContent = validation.message;
						emailSuccess.style.display = 'block';
					} else {
						this.classList.add('error');
						emailError.textContent = validation.message;
						emailError.style.display = 'block';
					}
				}
			});

			// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ –ø–∞—Ä–æ–ª—è
			passwordInput.addEventListener('input', function () {
				const validation = validatePassword(this.value);

				passwordError.style.display = 'none';
				passwordSuccess.style.display = 'none';
				this.classList.remove('error', 'success');

				if (this.value.trim()) {
					if (validation.valid) {
						this.classList.add('success');
						passwordSuccess.textContent = validation.message;
						passwordSuccess.style.display = 'block';
					} else {
						this.classList.add('error');
						passwordError.textContent = validation.message;
						passwordError.style.display = 'block';
					}
				}
			});

			// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
			loginForm.addEventListener('submit', async function (e) {
				e.preventDefault();

				const email = emailInput.value.trim().toLowerCase();
				const password = passwordInput.value;

				// –í–∞–ª–∏–¥–∞—Ü–∏—è
				const emailValidation = validateEmail(email);
				const passwordValidation = validatePassword(password);

				let hasErrors = false;

				if (!emailValidation.valid) {
					emailInput.classList.add('error');
					emailError.textContent = emailValidation.message;
					emailError.style.display = 'block';
					hasErrors = true;
				}

				if (!passwordValidation.valid) {
					passwordInput.classList.add('error');
					passwordError.textContent = passwordValidation.message;
					passwordError.style.display = 'block';
					hasErrors = true;
				}

				if (hasErrors) {
					return;
				}

				// –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
				loginButton.disabled = true;
				loginButton.textContent = 'üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ...';

				try {
					// –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					const user = await findUser(email, password);

					if (user) {
						// –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
						// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
						localStorage.setItem('userLoggedIn', 'true');
						localStorage.setItem('userEmail', email);
						localStorage.setItem('userName', user.employeeId || user.email.split('@')[0]);
						localStorage.setItem('userId', user.employeeId || user.id);
						localStorage.setItem('justLoggedIn', 'true'); // –§–ª–∞–≥ –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞

						// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
						loginButton.textContent = '‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!';
						loginButton.style.background = 'var(--main-success)';

						// –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
						setTimeout(() => {
							window.location.href = 'index.html';
						}, 1000);

					} else {
						// –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
						passwordInput.classList.add('error');
						passwordError.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
						passwordError.style.display = 'block';

						// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ Google Sheets
						try {
							const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
							const response = await fetch(url);
							const data = await response.json();
							const rows = data.values || [];

							const userExists = rows.some(row => {
								const rowEmail = row[1] ? row[1].toString().toLowerCase().trim() : '';
								return rowEmail === email;
							});

							if (!userExists) {
								emailInput.classList.add('error');
								emailError.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å!';
								emailError.style.display = 'block';
							}
						} catch (error) {
						}

						// –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
						loginButton.disabled = false;
						loginButton.textContent = 'üöÄ –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É';
						loginButton.style.background = 'var(--main-accent)';
					}
				} catch (error) {

					// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
					passwordInput.classList.add('error');
					passwordError.textContent = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
					passwordError.style.display = 'block';

					// –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
					loginButton.disabled = false;
					loginButton.textContent = 'üöÄ –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É';
					loginButton.style.background = 'var(--main-accent)';
				}
			});

			// –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
			function generateRandomPassword() {
				const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&*';
				let password = '';
				for (let i = 0; i < 12; i++) {
					password += chars.charAt(Math.floor(Math.random() * chars.length));
				}
				return password;
			}

			// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª—è
			document.getElementById('generatePasswordButton').addEventListener('click', async function () {
				const email = emailInput.value.trim().toLowerCase();

				if (!email) {
					emailInput.classList.add('error');
					emailError.textContent = '–í–≤–µ–¥–∏—Ç–µ email –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª—è';
					emailError.style.display = 'block';
					return;
				}

				const emailValidation = validateEmail(email);
				if (!emailValidation.valid) {
					emailInput.classList.add('error');
					emailError.textContent = emailValidation.message;
					emailError.style.display = 'block';
					return;
				}

				// –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
				this.disabled = true;
				this.textContent = 'üîÑ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º...';

				try {
					// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ Google Sheets
					const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
					const response = await fetch(url);

					if (!response.ok) {
						throw new Error('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Google Sheets');
					}

					const data = await response.json();
					const rows = data.values || [];

					let userFound = false;
					for (let i = 1; i < rows.length; i++) {
						const row = rows[i];
						const rowEmail = row[1] ? row[1].toString().toLowerCase().trim() : '';

						if (rowEmail === email) {
							userFound = true;
							break;
						}
					}

					if (!userFound) {
						// –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage –∫–∞–∫ fallback
						const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
						const localUserExists = registeredUsers.some(u => u.email === email);

						if (!localUserExists) {
							emailInput.classList.add('error');
							emailError.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å!';
							emailError.style.display = 'block';
							this.disabled = false;
							this.textContent = 'üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å';
							return;
						}
					}

					// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å
					const newPassword = generateRandomPassword();

					// –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–æ–ª—å –≤ localStorage –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
					const userIndex = registeredUsers.findIndex(u => u.email === email);
					if (userIndex !== -1) {
						registeredUsers[userIndex].password = newPassword;
						localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));
					}

					// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
					showPasswordModal(newPassword);

					// –û—á–∏—â–∞–µ–º –æ—à–∏–±–∫–∏
					emailInput.classList.remove('error');
					emailInput.classList.add('success');
					emailError.style.display = 'none';

					// –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è
					passwordInput.value = '';
					passwordInput.classList.remove('error', 'success');
					passwordError.style.display = 'none';
					passwordSuccess.style.display = 'none';

					// –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					// alert —É–±—Ä–∞–Ω - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–∞—Ä–æ–ª–µ–º

				} catch (error) {

					// –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ API, –ø—Ä–æ–±—É–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å localStorage
					const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
					const userIndex = registeredUsers.findIndex(u => u.email === email);

					if (userIndex === -1) {
						emailInput.classList.add('error');
						emailError.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω. –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.';
						emailError.style.display = 'block';
					} else {
						// –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–æ–ª—å –≤ localStorage
						const newPassword = generateRandomPassword();
						registeredUsers[userIndex].password = newPassword;
						localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));

						showPasswordModal(newPassword);

						emailInput.classList.remove('error');
						emailInput.classList.add('success');
						emailError.style.display = 'none';

						// alert —É–±—Ä–∞–Ω - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–∞—Ä–æ–ª–µ–º
					}
				}

				// –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
				this.disabled = false;
				this.textContent = 'üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å';
			});			// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º –ø–∞—Ä–æ–ª—è
			function showPasswordModal(password) {
				document.getElementById('generatedPassword').textContent = password;
				document.getElementById('passwordModal').style.display = 'block';
				document.body.style.overflow = 'hidden';
			}

			function closePasswordModal() {
				document.getElementById('passwordModal').style.display = 'none';
				document.body.style.overflow = 'auto';
			}

			// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
			document.getElementById('closePasswordModalBtn').addEventListener('click', closePasswordModal);

			// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
			document.getElementById('passwordModal').addEventListener('click', function (e) {
				if (e.target === this) {
					closePasswordModal();
				}
			});

			// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –∫–ª–∏–∫–µ
			document.getElementById('generatedPassword').addEventListener('click', copyPassword);

			function copyPassword() {
				const passwordElement = document.getElementById('generatedPassword');
				const password = passwordElement.textContent;

				// –ö–æ–ø–∏—Ä—É–µ–º –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
				navigator.clipboard.writeText(password).then(() => {
					// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ
					passwordElement.style.background = '#d4edda';
					passwordElement.style.border = '2px solid #28a745';
					passwordElement.innerHTML = '‚úÖ –°–ö–û–ü–ò–†–û–í–ê–ù–û!';

					// –ß–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–∞—Ä–æ–ª—å
					setTimeout(() => {
						passwordElement.style.background = 'white';
						passwordElement.style.border = '2px dashed var(--main-accent)';
						passwordElement.textContent = password;
					}, 1000);
				}).catch(() => {
					// –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, –ø—Ä–æ—Å—Ç–æ –≤—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç
					passwordElement.select();
				});
			}

			// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ —É–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
			const isLoggedIn = localStorage.getItem('userLoggedIn');
			const userEmail = localStorage.getItem('userEmail');

			if (isLoggedIn === 'true' && userEmail && userEmail.endsWith('@rostov.etagi.com')) {
				window.location.href = 'index.html';
			}

		}); // –ö–æ–Ω–µ—Ü DOMContentLoaded
	</script>
</body>

</html>
